[PoC RESULT]: False
[PoC MSG]:
============================== Run PoC ==============================
------------------------------ Standard Output ------------------------------

----------------------------------------------------------------------
FAIL: home_test.go:153: HomeInterfaceSuite.TestConnectedPlugAppArmorWithAttribAll

home_test.go:170:
    c.Check(apparmorSpec.SnippetForTag("snap.home-plug-snap.app2"), testutil.Contains, `audit deny @{HOME}/bin/{,**} wl,`)
... container string = "" +
...     "\n" +
...     "# Allow non-owner read to non-hidden and non-snap files and directories\n" +
...     "capability dac_read_search,\n" +
...     "@{HOME}/               r,\n" +
...     "@{HOME}/[^s.]**        r,\n" +
...     "@{HOME}/s[^n]**        r,\n" +
...     "@{HOME}/sn[^a]**       r,\n" +
...     "@{HOME}/sna[^p]**      r,\n" +
...     "@{HOME}/snap[^/]**     r,\n" +
...     "@{HOME}/{s,sn,sna}{,/} r,\n" +
...     "\n" +
...     "\n" +
...     "# Description: Can access non-hidden files in user's $HOME. This is restricted\n" +
...     "# because it gives file access to all of the user's $HOME.\n" +
...     "\n" +
...     "# Note, @{HOME} is the user's $HOME, not the snap's $HOME\n" +
...     "\n" +
...     "# Allow read access to toplevel $HOME for the user\n" +
...     "owner @{HOME}/ r,\n" +
...     "\n" +
...     "# Allow read/write access to all files in @{HOME}, except snap application\n" +
...     "# data in @{HOME}/snap and toplevel hidden directories in @{HOME}.\n" +
...     "owner @{HOME}/[^s.]**             rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/s[^n]**             rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/sn[^a]**            rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/sna[^p]**           rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/snap[^/]**          rwkl###HOME_IX###,\n" +
...     "\n" +
...     "# Allow creating a few files not caught above\n" +
...     "owner @{HOME}/{s,sn,sna}{,/} rwkl###HOME_IX###,\n" +
...     "\n" +
...     "# Allow access to @{HOME}/snap/ to allow directory traversals from\n" +
...     "# @{HOME}/snap/@{SNAP_INSTANCE_NAME} through @{HOME}/snap to @{HOME}.\n" +
...     "# While this leaks snap names, it fixes usability issues for snaps\n" +
...     "# that require this transitional interface.\n" +
...     "owner @{HOME}/snap/ r,\n" +
...     "\n" +
...     "# Allow access to gvfs mounts for files owned by the user (including hidden\n" +
...     "# files; only allow writes to files, not the mount point).\n" +
...     "owner /run/user/[0-9]*/gvfs/{,**} r,\n" +
...     "owner /run/user/[0-9]*/gvfs/*/**  w,\n" +
...     "\n" +
...     "# Block writes to the well-known directory included in\n" +
...     "# the user's PATH on several distributions\n" +
...     "deny @{HOME}/bin/{,**} wl,\n"
... elem string = "audit deny @{HOME}/bin/{,**} wl,"

home_test.go:172:
    c.Check(apparmorSpec.SnippetForTag("snap.home-plug-snap.app2"), testutil.Contains, `audit deny @{HOME}/bin wl,`)
... container string = "" +
...     "\n" +
...     "# Allow non-owner read to non-hidden and non-snap files and directories\n" +
...     "capability dac_read_search,\n" +
...     "@{HOME}/               r,\n" +
...     "@{HOME}/[^s.]**        r,\n" +
...     "@{HOME}/s[^n]**        r,\n" +
...     "@{HOME}/sn[^a]**       r,\n" +
...     "@{HOME}/sna[^p]**      r,\n" +
...     "@{HOME}/snap[^/]**     r,\n" +
...     "@{HOME}/{s,sn,sna}{,/} r,\n" +
...     "\n" +
...     "\n" +
...     "# Description: Can access non-hidden files in user's $HOME. This is restricted\n" +
...     "# because it gives file access to all of the user's $HOME.\n" +
...     "\n" +
...     "# Note, @{HOME} is the user's $HOME, not the snap's $HOME\n" +
...     "\n" +
...     "# Allow read access to toplevel $HOME for the user\n" +
...     "owner @{HOME}/ r,\n" +
...     "\n" +
...     "# Allow read/write access to all files in @{HOME}, except snap application\n" +
...     "# data in @{HOME}/snap and toplevel hidden directories in @{HOME}.\n" +
...     "owner @{HOME}/[^s.]**             rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/s[^n]**             rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/sn[^a]**            rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/sna[^p]**           rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/snap[^/]**          rwkl###HOME_IX###,\n" +
...     "\n" +
...     "# Allow creating a few files not caught above\n" +
...     "owner @{HOME}/{s,sn,sna}{,/} rwkl###HOME_IX###,\n" +
...     "\n" +
...     "# Allow access to @{HOME}/snap/ to allow directory traversals from\n" +
...     "# @{HOME}/snap/@{SNAP_INSTANCE_NAME} through @{HOME}/snap to @{HOME}.\n" +
...     "# While this leaks snap names, it fixes usability issues for snaps\n" +
...     "# that require this transitional interface.\n" +
...     "owner @{HOME}/snap/ r,\n" +
...     "\n" +
...     "# Allow access to gvfs mounts for files owned by the user (including hidden\n" +
...     "# files; only allow writes to files, not the mount point).\n" +
...     "owner /run/user/[0-9]*/gvfs/{,**} r,\n" +
...     "owner /run/user/[0-9]*/gvfs/*/**  w,\n" +
...     "\n" +
...     "# Block writes to the well-known directory included in\n" +
...     "# the user's PATH on several distributions\n" +
...     "deny @{HOME}/bin/{,**} wl,\n"
... elem string = "audit deny @{HOME}/bin wl,"


----------------------------------------------------------------------
FAIL: home_test.go:142: HomeInterfaceSuite.TestConnectedPlugAppArmorWithoutAttrib

home_test.go:148:
    c.Check(apparmorSpec.SnippetForTag("snap.other.app"), testutil.Contains, `audit deny @{HOME}/bin/{,**} wl,`)
... container string = "" +
...     "\n" +
...     "# Description: Can access non-hidden files in user's $HOME. This is restricted\n" +
...     "# because it gives file access to all of the user's $HOME.\n" +
...     "\n" +
...     "# Note, @{HOME} is the user's $HOME, not the snap's $HOME\n" +
...     "\n" +
...     "# Allow read access to toplevel $HOME for the user\n" +
...     "owner @{HOME}/ r,\n" +
...     "\n" +
...     "# Allow read/write access to all files in @{HOME}, except snap application\n" +
...     "# data in @{HOME}/snap and toplevel hidden directories in @{HOME}.\n" +
...     "owner @{HOME}/[^s.]**             rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/s[^n]**             rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/sn[^a]**            rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/sna[^p]**           rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/snap[^/]**          rwkl###HOME_IX###,\n" +
...     "\n" +
...     "# Allow creating a few files not caught above\n" +
...     "owner @{HOME}/{s,sn,sna}{,/} rwkl###HOME_IX###,\n" +
...     "\n" +
...     "# Allow access to @{HOME}/snap/ to allow directory traversals from\n" +
...     "# @{HOME}/snap/@{SNAP_INSTANCE_NAME} through @{HOME}/snap to @{HOME}.\n" +
...     "# While this leaks snap names, it fixes usability issues for snaps\n" +
...     "# that require this transitional interface.\n" +
...     "owner @{HOME}/snap/ r,\n" +
...     "\n" +
...     "# Allow access to gvfs mounts for files owned by the user (including hidden\n" +
...     "# files; only allow writes to files, not the mount point).\n" +
...     "owner /run/user/[0-9]*/gvfs/{,**} r,\n" +
...     "owner /run/user/[0-9]*/gvfs/*/**  w,\n" +
...     "\n" +
...     "# Block writes to the well-known directory included in\n" +
...     "# the user's PATH on several distributions\n" +
...     "deny @{HOME}/bin/{,**} wl,\n"
... elem string = "audit deny @{HOME}/bin/{,**} wl,"

home_test.go:149:
    c.Check(apparmorSpec.SnippetForTag("snap.other.app"), testutil.Contains, `audit deny @{HOME}/bin wl,`)
... container string = "" +
...     "\n" +
...     "# Description: Can access non-hidden files in user's $HOME. This is restricted\n" +
...     "# because it gives file access to all of the user's $HOME.\n" +
...     "\n" +
...     "# Note, @{HOME} is the user's $HOME, not the snap's $HOME\n" +
...     "\n" +
...     "# Allow read access to toplevel $HOME for the user\n" +
...     "owner @{HOME}/ r,\n" +
...     "\n" +
...     "# Allow read/write access to all files in @{HOME}, except snap application\n" +
...     "# data in @{HOME}/snap and toplevel hidden directories in @{HOME}.\n" +
...     "owner @{HOME}/[^s.]**             rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/s[^n]**             rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/sn[^a]**            rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/sna[^p]**           rwkl###HOME_IX###,\n" +
...     "owner @{HOME}/snap[^/]**          rwkl###HOME_IX###,\n" +
...     "\n" +
...     "# Allow creating a few files not caught above\n" +
...     "owner @{HOME}/{s,sn,sna}{,/} rwkl###HOME_IX###,\n" +
...     "\n" +
...     "# Allow access to @{HOME}/snap/ to allow directory traversals from\n" +
...     "# @{HOME}/snap/@{SNAP_INSTANCE_NAME} through @{HOME}/snap to @{HOME}.\n" +
...     "# While this leaks snap names, it fixes usability issues for snaps\n" +
...     "# that require this transitional interface.\n" +
...     "owner @{HOME}/snap/ r,\n" +
...     "\n" +
...     "# Allow access to gvfs mounts for files owned by the user (including hidden\n" +
...     "# files; only allow writes to files, not the mount point).\n" +
...     "owner /run/user/[0-9]*/gvfs/{,**} r,\n" +
...     "owner /run/user/[0-9]*/gvfs/*/**  w,\n" +
...     "\n" +
...     "# Block writes to the well-known directory included in\n" +
...     "# the user's PATH on several distributions\n" +
...     "deny @{HOME}/bin/{,**} wl,\n"
... elem string = "audit deny @{HOME}/bin wl,"

OOPS: 0 passed, 2 FAILED
--- FAIL: Test (0.01s)
FAIL
FAIL	github.com/snapcore/snapd/interfaces/builtin	0.014s
FAIL

------------------------------ Finish Evaluation ------------------------------


[UnitTest RESULT]: None
[UnitTest MSG]:
 None

[Validation TYPE]: validation_fail