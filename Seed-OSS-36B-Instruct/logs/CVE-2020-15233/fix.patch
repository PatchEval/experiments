--- a/authorize_helper.go
+++ b/authorize_helper.go
@@ -135,7 +135,13 @@
 		return false
 	}
 
-	if requested.Scheme == "http" && isLoopbackAddress(requested.Host) && registered.Path == requested.Path {
+	// Require exact host match for loopback URIs to prevent host override attacks
+	if requested.Host != registered.Host {
+		return false
+	}
+
+	// Require exact path and query match for loopback URIs to prevent parameter injection
+	if requested.Scheme == "http" && isLoopbackAddress(requested.Host) && registered.Path == requested.Path && registered.RawQuery == requested.RawQuery {
 		return true
 	}
 

