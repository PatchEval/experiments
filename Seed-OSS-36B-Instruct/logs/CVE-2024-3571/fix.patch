--- a/libs/langchain/langchain/storage/file_system.py
+++ b/libs/langchain/langchain/storage/file_system.py
@@ -55,7 +55,15 @@
         """
         if not re.match(r"^[a-zA-Z0-9_.\-/]+$", key):
             raise InvalidKeyException(f"Invalid characters in key: {key}")
-        return self.root_path / key
+        
+        full_path = self.root_path / key
+        # Ensure path doesn't escape root directory
+        try:
+            full_path.relative_to(self.root_path)
+        except ValueError:
+            raise InvalidKeyException(f"Path traversal attempt blocked for key: {key}")
+        
+        return full_path
 
     def mget(self, keys: Sequence[str]) -> List[Optional[bytes]]:
         """Get the values associated with the given keys.

