--- a/django/contrib/admindocs/views.py
+++ b/django/contrib/admindocs/views.py
@@ -329,15 +329,22 @@
         else:
             # This doesn't account for template loaders (#24128).
             for index, directory in enumerate(default_engine.dirs):
-                template_file = Path(directory) / template
-                if template_file.exists():
-                    template_contents = template_file.read_text()
+                tmpl_path = Path(directory) / template
+                abs_dir = Path(directory).resolve()
+                abs_tmpl = tmpl_path.resolve()
+                
+                # Check if template is inside the allowed directory
+                if abs_tmpl.is_relative_to(abs_dir):
+                    exists = abs_tmpl.exists()
+                    contents = abs_tmpl.read_text() if exists else ''
                 else:
-                    template_contents = ''
+                    exists = False
+                    contents = ''
+                
                 templates.append({
-                    'file': template_file,
-                    'exists': template_file.exists(),
-                    'contents': template_contents,
+                    'file': tmpl_path,
+                    'exists': exists,
+                    'contents': contents,
                     'order': index,
                 })
         return super().get_context_data(**{

