--- a/types/manifest/manifest.go
+++ b/types/manifest/manifest.go
@@ -122,9 +122,21 @@
 			cl, _ := strconv.Atoi(mc.header.Get("Content-Length"))
 			c.desc.Size = int64(cl)
 		}
-		if c.desc.Digest == "" {
-			c.desc.Digest, _ = digest.Parse(mc.header.Get("Docker-Content-Digest"))
-		}
+			headerDigestStr := mc.header.Get("Docker-Content-Digest")
+			if headerDigestStr != "" {
+				headerDigest, err := digest.Parse(headerDigestStr)
+				if err != nil {
+					return nil, fmt.Errorf("invalid Docker-Content-Digest header: %w", err)
+				}
+				// Verify header digest matches pinned digest if present
+				if c.desc.Digest != "" && c.desc.Digest != headerDigest {
+					return nil, fmt.Errorf("header digest %s does not match pinned digest %s", headerDigest, c.desc.Digest)
+				}
+				// Set digest from header if not already pinned
+				if c.desc.Digest == "" {
+					c.desc.Digest = headerDigest
+				}
+			}
 		c.setRateLimit(mc.header)
 	}
 	if mc.orig != nil {

