[PoC RESULT]: False
[PoC MSG]:
============================== Run PoC ==============================
------------------------------ Standard Output ------------------------------
time="2025-10-30T12:30:32Z" level=warning msg="grbac abandoned the periodic loader because loadInterval is less than 0"
--- FAIL: Test_CVE_2023_22480_Kubeconfig_Access_Control (0.02s)
    --- FAIL: Test_CVE_2023_22480_Kubeconfig_Access_Control/Unauthorized_access_to_kubeconfig_route_should_be_denied (0.00s)
panic: runtime error: invalid memory address or nil pointer dereference [recovered]
	panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x1 addr=0xa8 pc=0x1cd3a5d]

goroutine 88 [running]:
testing.tRunner.func1.2({0x41f3c00, 0x69a9610})
	/usr/local/go/src/testing/testing.go:1526 +0x24e
testing.tRunner.func1()
	/usr/local/go/src/testing/testing.go:1529 +0x39f
panic({0x41f3c00, 0x69a9610})
	/usr/local/go/src/runtime/panic.go:884 +0x213
github.com/jinzhu/gorm.(*DB).clone(0x0)
	/root/go/pkg/mod/github.com/jinzhu/gorm@v1.9.12/main.go:848 +0x1d
github.com/jinzhu/gorm.(*DB).Where(0xc00126a318?, {0x401b5a0?, 0x4e22490}, {0xc0006334d0, 0x1, 0x1})
	/root/go/pkg/mod/github.com/jinzhu/gorm@v1.9.12/main.go:235 +0x47
github.com/KubeOperator/KubeOperator/pkg/repository.clusterRepository.GetWithPreload({}, {_, _}, {_, _, _})
	/workspace/KubeOperator/pkg/repository/cluster.go:35 +0xca
github.com/KubeOperator/KubeOperator/pkg/service.clusterService.GetKubeconfig({{0x4e60258, 0x6e30060}, {0x4e66be0, 0x6e30060}, {0x4e48700, 0x6e30060}, {0x4e63440, 0x6e30060}, {0x4e3efc0, 0xc0004e0f50}, ...}, ...)
	/workspace/KubeOperator/pkg/service/cluster.go:526 +0xa5
github.com/KubeOperator/KubeOperator/pkg/router/v1.downloadKubeconfig({0x4e93838, 0xc001066d80})
	/workspace/KubeOperator/pkg/router/v1/white.go:17 +0x129
github.com/kataras/iris/v12/context.Do({0x4e93838, 0xc001066d80}, {0xc00040d9f0?, 0xc000271e60?, 0xc001235880?})
	/root/go/pkg/mod/github.com/kataras/iris/v12@v12.1.8/context/context.go:1030 +0x63
github.com/kataras/iris/v12/context.(*context).Do(0xc001cc5740?, {0xc00040d9f0?, 0x22?, 0xc001066db0?})
	/root/go/pkg/mod/github.com/kataras/iris/v12@v12.1.8/context/context.go:1217 +0x31
github.com/kataras/iris/v12/core/router.(*routerHandler).HandleRequest(0xc001c8ff60, {0x4e93838, 0xc001066d80})
	/root/go/pkg/mod/github.com/kataras/iris/v12@v12.1.8/core/router/handler.go:250 +0x62f
github.com/kataras/iris/v12/core/router.(*Router).BuildRouter.func1({0x4e57280?, 0xc000549d00?}, 0xc000113601?)
	/root/go/pkg/mod/github.com/kataras/iris/v12@v12.1.8/core/router/router.go:135 +0x6b
github.com/kataras/iris/v12/core/router.(*Router).ServeHTTP(...)
	/root/go/pkg/mod/github.com/kataras/iris/v12@v12.1.8/core/router/router.go:227
github.com/gavv/httpexpect.Binder.RoundTrip({{0x4e32240?, 0xc000a20f30?}, 0x0?}, 0xc00032bf00)
	/root/go/pkg/mod/github.com/gavv/httpexpect@v2.0.0+incompatible/binder.go:62 +0x3c6
net/http.send(0xc00032bf00, {0x4e391e0, 0xc001ca3d70}, {0x8?, 0x47164e0?, 0x0?})
	/usr/local/go/src/net/http/client.go:252 +0x5f7
net/http.(*Client).send(0xc000568480, 0xc00032bf00, {0x0?, 0x0?, 0x0?})
	/usr/local/go/src/net/http/client.go:176 +0x9b
net/http.(*Client).do(0xc000568480, 0xc00032bf00)
	/usr/local/go/src/net/http/client.go:716 +0x8fb
net/http.(*Client).Do(0x6e2ac18?, 0x16a5d87?)
	/usr/local/go/src/net/http/client.go:582 +0x19
github.com/gavv/httpexpect.(*Request).sendRequest(0xc0001eca00)
	/root/go/pkg/mod/github.com/gavv/httpexpect@v2.0.0+incompatible/request.go:983 +0x3b
github.com/gavv/httpexpect.(*Request).roundTrip(0xc0001eca00)
	/root/go/pkg/mod/github.com/gavv/httpexpect@v2.0.0+incompatible/request.go:906 +0x127
github.com/gavv/httpexpect.(*Request).Expect(0xc0001eca00)
	/root/go/pkg/mod/github.com/gavv/httpexpect@v2.0.0+incompatible/request.go:866 +0x36
github.com/KubeOperator/KubeOperator/pkg/router/v1.Test_CVE_2023_22480_Kubeconfig_Access_Control.func1(0xc000683a00)
	/workspace/KubeOperator/pkg/router/v1/v1api_test.go:21 +0x45
testing.tRunner(0xc000683a00, 0xc000632f40)
	/usr/local/go/src/testing/testing.go:1576 +0x10b
created by testing.(*T).Run
	/usr/local/go/src/testing/testing.go:1629 +0x3ea
FAIL	github.com/KubeOperator/KubeOperator/pkg/router/v1	0.142s
FAIL

------------------------------ Standard Error ------------------------------
go: finding module for package github.com/yudai/pp
go: finding module for package github.com/fasthttp-contrib/websocket
go: finding module for package github.com/golang-jwt/jwt
go: found github.com/golang-jwt/jwt in github.com/golang-jwt/jwt v3.2.2+incompatible
go: found github.com/fasthttp-contrib/websocket in github.com/fasthttp-contrib/websocket v0.0.0-20160511215533-1f3b11f56072
go: found github.com/yudai/pp in github.com/yudai/pp v2.0.1+incompatible

------------------------------ Finish Evaluation ------------------------------


[UnitTest RESULT]: None
[UnitTest MSG]:
 None

[Validation TYPE]: validation_fail