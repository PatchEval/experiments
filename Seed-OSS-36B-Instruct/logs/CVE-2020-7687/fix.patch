--- a/index.js
+++ b/index.js
@@ -10,29 +10,41 @@
     if (port === undefined) port = 80;
     var server = http.createServer(function (req, res) {
 
-        var uri = url.parse(req.url).pathname,
-            filename = path.join(root, uri);
+        var uri = url.parse(req.url).pathname;
+        var initialPath = path.join(root, uri);
+        var resolvedPath = path.resolve(initialPath);
 
-        if (uri.charAt(uri.length - 1) === '/') {
-            filename += 'index.html';
+        // Check for path traversal attacks
+        const relativePath = path.relative(root, resolvedPath);
+        if (relativePath.startsWith('..') || path.isAbsolute(relativePath)) {
+            if (wordy) console.log('Error 403: Path traversal attempt');
+            res.writeHead(403, {'Content-Type': 'text/plain'});
+            res.end('Forbidden');
+            return;
         }
 
-        if (wordy) console.log('GET:' + uri + ' -> ' + filename);
+        // Handle directory index files
+        var finalFilename = resolvedPath;
+        if (uri.charAt(uri.length - 1) === '/') {
+            finalFilename = path.join(resolvedPath, 'index.html');
+        }
 
-        fs.exists(filename, function (exists) {
+        if (wordy) console.log('GET:' + uri + ' -> ' + finalFilename);
+
+        fs.exists(finalFilename, function (exists) {
             if (!exists) {
                 if (wordy) console.log('Error 404');
                 res.writeHead(404, {'Content-Type': 'text/plain'});
                 res.end('Error 404');
                 return;
             }
-            if (fs.statSync(filename).isDirectory() && uri.charAt(uri.length - 1) !== '/') {
+            if (fs.statSync(finalFilename).isDirectory() && uri.charAt(uri.length - 1) !== '/') {
                 if (wordy) console.log('Redirection 303');
                 res.writeHead(303,{ 'Location': uri + '/' });
                 res.end('Redirecting to: ' + uri + '/');
                 return;
             }
-            fs.readFile(filename, 'binary', function(err, file) {
+            fs.readFile(finalFilename, 'binary', function(err, file) {
                 if(err) {
                     if (wordy) console.log('Error 500');
                     res.writeHead(500, {'Content-Type': 'text/plain'});
@@ -41,7 +53,7 @@
                 }
                 if (wordy) console.log('Ok 200');
                 res.writeHead(200, {
-                    'Content-Type': mime.lookup(filename) + ';' + mime.charsets.lookup(mime.lookup(filename)) 
+                    'Content-Type': mime.lookup(finalFilename) + ';' + mime.charsets.lookup(mime.lookup(finalFilename)) 
                 });
                 res.write(file, 'binary');
                 res.end();

