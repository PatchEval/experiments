--- a/lib/router.js
+++ b/lib/router.js
@@ -730,7 +730,18 @@
     };
     dispatch["static"] = function(pathname, req, res) {
       var full_path;
-      full_path = "" + dispatch.static_route + (unescape(pathname));
+      const userPath = decodeURIComponent(pathname);
+      const resolvedPath = path_tools.resolve(dispatch.static_route, userPath);
+      const normalizedStatic = path_tools.normalize(dispatch.static_route);
+      const normalizedResolved = path_tools.normalize(resolvedPath);
+      
+      // Prevent path traversal attacks by restricting to static directory
+      const isWithinStatic = normalizedResolved === normalizedStatic || normalizedResolved.startsWith(normalizedStatic + path_tools.sep);
+      if (!isWithinStatic) {
+        return dispatch._404(req, res, pathname);
+      }
+      
+      full_path = resolvedPath;
       return fs.exists(full_path, function(exists) {
         var e, error;
         if (exists) {

