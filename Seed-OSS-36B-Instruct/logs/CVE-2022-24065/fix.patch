--- a/cookiecutter/vcs.py
+++ b/cookiecutter/vcs.py
@@ -64,6 +64,13 @@
     :param no_input: Suppress all user prompts when calling via API.
     :returns: str with path to the new directory of the repository.
     """
+    import re
+    
+    # Validate checkout parameter to prevent command injection
+    if checkout is not None:
+        # Only allow alphanumeric characters, hyphens, underscores, and dots
+        if not re.match(r'^[a-zA-Z0-9_\-\.]+$', checkout):
+            raise ValueError(f"Invalid checkout parameter: {checkout}")
     # Ensure that clone_to_dir exists
     clone_to_dir = os.path.expanduser(clone_to_dir)
     make_sure_path_exists(clone_to_dir)
@@ -98,7 +105,8 @@
                 stderr=subprocess.STDOUT,
             )
             if checkout is not None:
-                subprocess.check_output(  # nosec
+                # Use shell=False (default) and pass as list to prevent command injection
+                subprocess.check_output(
                     [repo_type, 'checkout', checkout],
                     cwd=repo_dir,
                     stderr=subprocess.STDOUT,

