[PoC RESULT]: False
[PoC MSG]:
============================== Run PoC ==============================
------------------------------ Standard Output ------------------------------
TAP version 13
# Subtest: Filter on URL
    # Subtest: for GitHub private filters
        1..4
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"rulesCount":2,"msg":"loading new rules","time":"2025-10-30T12:27:11.684Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/repos/:name/:repo/contents/:path*/package.json","msg":"adding new filter rule","time":"2025-10-30T12:27:11.685Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/repos/:name/:repo/contents/:path*/docs/*","msg":"adding new filter rule","time":"2025-10-30T12:27:11.685Z","v":0}
        ok 1 - Filters loaded
        # Subtest: should allow valid /repos path to manifest
            ok 1 - no error
            ok 2 - contains expected path
            1..2
        ok 2 - should allow valid /repos path to manifest # time=2.247ms
        
        # Subtest: should block when manifest appears after fragment identifier
            ok 1 - has been blocked
            ok 2 - no follow allowed
            1..2
        ok 3 - should block when manifest appears after fragment identifier # time=1.053ms
        
        # Subtest: should block when path includes directory traversal
            not ok 1 - Cannot read properties of null (reading 'message')
              ---
              stack: |
                test/unit/filters.test.js:47:23
                lib/filters/index.js:187:12
                Test.<anonymous> (test/unit/filters.test.js:43:7)
              at:
                line: 47
                column: 23
                file: test/unit/filters.test.js
              type: TypeError
              tapCaught: testFunctionThrow
              test: should block when path includes directory traversal
              source: |
                t.equal(error.message, 'blocked', 'has been blocked');
              ...
            
            1..1
            # failed 1 test
        not ok 4 - should block when path includes directory traversal # time=7.886ms
        
        # failed 1 of 4 tests
    not ok 1 - for GitHub private filters # time=22.37ms
    
    1..1
    # failed 1 test
not ok 1 - Filter on URL # time=25.936ms

{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"rulesCount":6,"msg":"loading new rules","time":"2025-10-30T12:27:11.707Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/","msg":"adding new filter rule","time":"2025-10-30T12:27:11.707Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/filtered-on-query","msg":"adding new filter rule","time":"2025-10-30T12:27:11.707Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/filtered-on-query-and-body","msg":"adding new filter rule","time":"2025-10-30T12:27:11.707Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/graphql","msg":"adding new filter rule","time":"2025-10-30T12:27:11.707Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/basic-auth","msg":"adding new filter rule","time":"2025-10-30T12:27:11.707Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/token-auth","msg":"adding new filter rule","time":"2025-10-30T12:27:11.707Z","v":0}
# Subtest: filter on body
    ok 1 - filters loaded
    ok 2 - no error
    ok 3 - allows the path request
    ok 4 - no error
    ok 5 - allows the path request
    ok 6 - has been blocked
    ok 7 - no follow allowed
    ok 8 - has been blocked
    ok 9 - no follow allowed
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":50,"error":{},"path":"query","regex":"INVALID regex (","msg":"failed to test regex rule","time":"2025-10-30T12:27:11.710Z","v":0}
    # Subtest: graphql - find globs - valid query
        ok 1 - no error
        ok 2 - allows the path request
        1..2
    ok 10 - graphql - find globs - valid query # time=1.091ms
    
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":50,"error":{},"path":"query","regex":"INVALID regex (","msg":"failed to test regex rule","time":"2025-10-30T12:27:11.713Z","v":0}
    # Subtest: graphql - find globs - noSQL injection
        ok 1 - got an error
        ok 2 - has been blocked
        ok 3 - no follow allowed
        1..3
    ok 11 - graphql - find globs - noSQL injection # time=1.144ms
    
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":50,"error":{},"path":"query","regex":"INVALID regex (","msg":"failed to test regex rule","time":"2025-10-30T12:27:11.716Z","v":0}
    # Subtest: graphql - find pull requests - invalid
        ok 1 - got an error
        ok 2 - has been blocked
        ok 3 - no follow allowed
        1..3
    ok 12 - graphql - find pull requests - invalid # time=0.896ms
    
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":50,"error":{},"path":"query","regex":"INVALID regex (","msg":"failed to test regex rule","time":"2025-10-30T12:27:11.718Z","v":0}
    # Subtest: graphql - find pull requests - open
        ok 1 - no error
        ok 2 - allows the path request
        1..2
    ok 13 - graphql - find pull requests - open # time=0.65ms
    
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":50,"error":{},"path":"query","regex":"INVALID regex (","msg":"failed to test regex rule","time":"2025-10-30T12:27:11.720Z","v":0}
    # Subtest: graphql - find pull requests - closed
        ok 1 - no error
        ok 2 - allows the path request
        1..2
    ok 14 - graphql - find pull requests - closed # time=0.669ms
    
    1..14
ok 2 - filter on body # time=13.967ms

{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"rulesCount":6,"msg":"loading new rules","time":"2025-10-30T12:27:11.722Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/","msg":"adding new filter rule","time":"2025-10-30T12:27:11.722Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/filtered-on-query","msg":"adding new filter rule","time":"2025-10-30T12:27:11.722Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/filtered-on-query-and-body","msg":"adding new filter rule","time":"2025-10-30T12:27:11.722Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/graphql","msg":"adding new filter rule","time":"2025-10-30T12:27:11.722Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/basic-auth","msg":"adding new filter rule","time":"2025-10-30T12:27:11.722Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/token-auth","msg":"adding new filter rule","time":"2025-10-30T12:27:11.722Z","v":0}
# Subtest: Filter on querystring
    1..10
    ok 1 - filters loaded
    ok 2 - no error
    ok 3 - allows the path request
    ok 4 - no error
    ok 5 - allows the path request
    ok 6 - has been blocked
    ok 7 - no follow allowed
    ok 8 - has been blocked
    ok 9 - no follow allowed
    # Subtest: fragment identifiers validation
        1..2
        # Subtest: should not allow access to sensitive files by putting the manifest after a fragment
            ok 1 - errors as expected
            ok 2 - follow not allowed
            1..2
        ok 1 - should not allow access to sensitive files by putting the manifest after a fragment # time=0.841ms
        
        # Subtest: should ignore any non-manifest files after the fragment identifier
            ok 1 - no error
            ok 2 - contains the expected manifest in the query string
            1..2
        ok 2 - should ignore any non-manifest files after the fragment identifier # time=0.713ms
        
    ok 10 - fragment identifiers validation # time=5.467ms
    
ok 3 - Filter on querystring # time=10.446ms

{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"rulesCount":6,"msg":"loading new rules","time":"2025-10-30T12:27:11.733Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/","msg":"adding new filter rule","time":"2025-10-30T12:27:11.733Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/filtered-on-query","msg":"adding new filter rule","time":"2025-10-30T12:27:11.733Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/filtered-on-query-and-body","msg":"adding new filter rule","time":"2025-10-30T12:27:11.733Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/graphql","msg":"adding new filter rule","time":"2025-10-30T12:27:11.733Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/basic-auth","msg":"adding new filter rule","time":"2025-10-30T12:27:11.733Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/token-auth","msg":"adding new filter rule","time":"2025-10-30T12:27:11.733Z","v":0}
# Subtest: Filter on query and body
    1..10
    ok 1 - filters loaded
    ok 2 - no error
    ok 3 - allows the path request
    ok 4 - no error
    ok 5 - allows the path request
    ok 6 - has been blocked
    ok 7 - no follow allowed
    ok 8 - has been blocked
    ok 9 - no follow allowed
    # Subtest: fragment identifiers validation
        1..2
        # Subtest: should not allow access to sensitive files by putting the manifest after a fragment
            ok 1 - errors as expected
            ok 2 - follow not allowed
            1..2
        ok 1 - should not allow access to sensitive files by putting the manifest after a fragment # time=0.691ms
        
        # Subtest: should ignore any non-manifest files after the fragment identifier
            ok 1 - no error
            ok 2 - contains the expected manifest in the query string
            1..2
        ok 2 - should ignore any non-manifest files after the fragment identifier # time=0.856ms
        
    ok 10 - fragment identifiers validation # time=6.471ms
    
ok 4 - Filter on query and body # time=9.365ms

{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"rulesCount":6,"msg":"loading new rules","time":"2025-10-30T12:27:11.743Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/","msg":"adding new filter rule","time":"2025-10-30T12:27:11.743Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/filtered-on-query","msg":"adding new filter rule","time":"2025-10-30T12:27:11.743Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/filtered-on-query-and-body","msg":"adding new filter rule","time":"2025-10-30T12:27:11.743Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"post","path":"/graphql","msg":"adding new filter rule","time":"2025-10-30T12:27:11.743Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/basic-auth","msg":"adding new filter rule","time":"2025-10-30T12:27:11.743Z","v":0}
{"name":"snyk-broker","hostname":"7e085db2e1a0","pid":50,"level":30,"method":"get","path":"/token-auth","msg":"adding new filter rule","time":"2025-10-30T12:27:11.743Z","v":0}
# Subtest: filter with auth
    1..5
    ok 1 - filters loaded
    ok 2 - no error
    ok 3 - basic auth header returned
    ok 4 - no error
    ok 5 - token auth header returned
ok 5 - filter with auth # time=0.817ms

1..5
# failed 1 of 5 tests
# time=72.329ms

------------------------------ Finish Evaluation ------------------------------


[UnitTest RESULT]: None
[UnitTest MSG]:
 None

[Validation TYPE]: compilation_fail