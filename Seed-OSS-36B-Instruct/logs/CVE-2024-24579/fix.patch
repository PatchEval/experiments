--- a/pkg/file/tarutil.go
+++ b/pkg/file/tarutil.go
@@ -126,8 +126,21 @@
 
 // UntarToDirectory writes the contents of the given tar reader to the given destination
 func UntarToDirectory(reader io.Reader, dst string) error {
+	// Clean destination path to ensure consistent validation
+	dstClean := filepath.Clean(dst)
+	
 	visitor := func(entry TarFileEntry) error {
+		// Validate path doesn't escape destination directory
 		target := filepath.Join(dst, entry.Header.Name)
+		targetClean := filepath.Clean(target)
+		
+		// Check that target path remains within destination directory
+		if !filepath.IsAbs(dstClean) {
+			dstClean = filepath.Join("/", dstClean) // Make absolute for proper prefix check
+		}
+		if !strings.HasPrefix(targetClean, dstClean) {
+			return fmt.Errorf("path traversal attempt detected in tar entry: %q", entry.Header.Name)
+		}
 
 		switch entry.Header.Typeflag {
 		case tar.TypeDir:

