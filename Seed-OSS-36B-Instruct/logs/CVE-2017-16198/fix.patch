--- a/index.js
+++ b/index.js
@@ -29,16 +29,29 @@
 
         //补全文件路径
         if (path.extname(pathName) == "") {
-
-            if(!/\/$/.test(pathName)){
+            if (!/\/$/.test(pathName)) {
                 pathName += '/';
             }
-
             pathName += argvs.getDefault();
         }
 
-        //使用路径解析模块,组装实际文件路径 
-        var filePath = path.join(argvs.getPath(), pathName);
+        // Remove leading slashes to ensure path is relative to base directory
+        pathName = pathName.replace(/^\/+/, '');
+
+        // Get absolute base directory and resolve file path
+        const baseDir = path.resolve(argvs.getPath());
+        const filePath = path.resolve(baseDir, pathName);
+
+        // Check for path traversal (ensure file is within base directory)
+        const normalizedBase = path.normalize(baseDir);
+        const normalizedPath = path.normalize(filePath);
+        const isPathInside = normalizedPath === normalizedBase || normalizedPath.startsWith(normalizedBase + path.sep);
+
+        if (!isPathInside) {
+            res.writeHead(403, { 'Content-Type': 'text/html' });
+            res.end('<h1>403 Forbidden: Invalid path</h1>');
+            return;
+        }
 
         //判断文件是否存在 
         fs.exists(filePath, function(exists) {

