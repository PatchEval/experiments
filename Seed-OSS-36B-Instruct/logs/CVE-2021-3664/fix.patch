--- a/index.js
+++ b/index.js
@@ -105,6 +105,12 @@
  * @property {Boolean} slashes `true` if protocol is followed by "//", else `false`.
  * @property {String} rest Rest of the URL that is not part of the protocol.
  */
+
+/**
+ * List of trusted protocols to prevent open redirects
+ * @private
+ */
+var TRUSTED_PROTOCOLS = ['http:', 'https:', 'ftp:', 'mailto:', 'tel:', 'sms:'];
 
 /**
  * Extract protocol information from a URL with/without double slash ("//").
@@ -317,14 +323,15 @@
     url.password = instruction[1] || '';
   }
 
-  url.origin = url.protocol && url.host && url.protocol !== 'file:'
+  // Only set origin for trusted protocols
+  url.origin = url.protocol && url.host && TRUSTED_PROTOCOLS.includes(url.protocol + ':')
     ? url.protocol +'//'+ url.host
     : 'null';
 
   //
   // The href is just the compiled result.
   //
-  url.href = url.toString();
+  url.href = url.protocol && TRUSTED_PROTOCOLS.includes(url.protocol + ':') ? url.toString() : '';
 }
 
 /**

