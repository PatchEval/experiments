--- a/lib/ejs.js
+++ b/lib/ejs.js
@@ -268,11 +268,9 @@
 function cpOptsInData(data, opts) {
   _OPTS.forEach(function (p) {
     if (typeof data[p] != 'undefined') {
-      // Disallow setting the root opt for includes via a passed data obj
-      // Unsanitized, parameterized use of `render` could allow the
-      // include directory to be reset, opening up the possibility of
-      // remote code execution
-      if (p == 'root') {
+      // Disallow setting root/delimiter via data object to prevent
+      // directory traversal (root) and ReDoS (delimiter) attacks
+      if (p == 'root' || p == 'delimiter') {
         return;
       }
       opts[p] = data[p];

